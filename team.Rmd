---
title: "team.Rmd"
author: 'Chase Weida; Github: cweida; Bernard Fay: Github: bj99fay'
date: "3/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
```

## Cleaning
```{r}
#defense
defense <- read_excel('cyclonesFootball2019.xlsx', sheet='Defensive')
defense <- data.frame(defense)
defense$Name <- as.factor(defense$Name)
defense$Opponent_Opponent <- as.factor(defense$Opponent_Opponent)

defense <- defense %>% mutate_at(.vars=c(3:11), .funs= list(as.numeric))
defClean <- defense
str(defClean)

#offense
offense <- read_excel('cyclonesFootball2019.xlsx', sheet='Offensive')
offense$Name <- as.factor(offense$Name)
offense$Opponent_Opponent <- as.factor(offense$Opponent_Opponent)
offense <-separate(offense, "Passing_CMP-ATT", into=c("Passing_CMP", "Passing_ATT"), sep="-\r\n ")
offense <- mutate_at(offense, .vars=c(3:13), .funs=list(as.numeric))

offClean <- offense
str(offClean)

#biography
biography <- read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
biography <- data.frame(biography)

biography <- biography %>% separate(Height, sep = "-", into = c('Ft', 'inch'), remove = TRUE)  
biography$Ft <- as.numeric(biography$Ft)
biography$inch <- as.numeric(biography$inch)

biography$Height <- biography %>% transmute(inches = (Ft * 12) + inch)
biography <- biography %>% select(-c(3,4))
biography <- biography %>% mutate_at(.vars = c(1,2,4,5,6), .funs = list(as.factor)) %>% mutate_at(.vars = c(3), .funs = list(as.numeric))
bioClean <- biography
str(bioClean)
```

## Tidying(1)
### 1.
```{r}
dat1 <- defClean %>% pivot_longer(cols=c(3:11), names_to="Statistic")
```

### 2.
```{r}
dat1 %>% ggplot(aes(x=as.numeric(value))) + geom_bar(stat="count") + facet_wrap(~Statistic) + xlab("value")
```

There are several defensive skills that are rare. Pass_PB, Pass_QBH, Tackles_Sack, Tackles_TFL, Turnover_FF, Turnover_FR, and Turnover_INT are the rare defensive skills because very few players have non-zero values in these areas.

### 3.
```{r}
dat1 %>% head()
dat2 <- dat1 %>%
        filter(Opponent_Opponent == c("Kansas State", "West Virginia") & Statistic == "Tackles_Solo") %>%
        select(Name, Opponent_Opponent, value) %>%
        pivot_wider(names_from = Opponent_Opponent, values_from = value)
dat2$`West Virginia`[is.na(dat2$`West Virginia`)] <- 0
dat2$`Kansas State`[is.na(dat2$`Kansas State`)] <- 0
dat2 %>% ggplot(aes(x=`West Virginia`, y=`Kansas State`)) + geom_point() + 
        geom_text(aes(label=ifelse(`West Virginia`>2, as.character(Name),'')), hjust=0, vjust=0) +
        geom_text(aes(label=ifelse(`Kansas State`>2, as.character(Name),'')), hjust=0, vjust=0)
```

Iowa State had better defense against Kansas State as there were several players with more than 2 tackles in that game, compared to only two players with >2 tackles in the West Virginia game.

## Tidying (2)
### 1
```{r}

```

### 2
```{r}

```

## Joining
### 1
```{r}

```

### 2
```{r}

```

### 3
```{r}

```

### 4
```{r}

```